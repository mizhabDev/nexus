
<link rel="stylesheet" href="/style/eventModal.css">

<!-- Event Details Modal -->
<div id="eventModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title" id="modalEventTitle">Event Title</h2>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="modal-detail">
                <div class="modal-label">ğŸ“… Date & Time</div>
                <div class="modal-value large" id="modalEventDateTime"></div>
            </div>

            <div class="modal-detail">
                <div class="modal-label">ğŸ“ Description</div>
                <div class="modal-value" id="modalEventDescription"></div>
            </div>

            <div class="modal-detail">
                <div class="modal-label">ğŸ“ Location</div>
                <div class="modal-value large" id="modalEventLocation"></div>
            </div>

            <div class="modal-detail">
                <div class="modal-label">ğŸ’° Prize</div>
                <div class="modal-value large" id="modalEventPrize"></div>
            </div>

            <div class="modal-detail">
                <div class="modal-label">ğŸ‘¤ Created By</div>
                <div class="modal-value" id="modalEventCreator"></div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal()">Cancel</button>
            <button class="btn-book" onclick="bookEvent()">Book Event</button>
        </div>
    </div>
</div>

<script>
// Function to open modal with event details
function openEventModal(event) {
    try{
    const modal = document.getElementById('eventModal');
  
    console.log("this is form event "+event);
    console.log("this from modal"+modal);

    // Parse date and time from your event object
    let eventDate = new Date(event.date);        
    let eventTime = event.time;                 

    let formattedDate = eventDate
      .toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' });

    // Format time: "12:00 am"
    let timeObj = new Date('1970-01-01T' + eventTime);
    let formattedTime = timeObj
      .toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true }).toLowerCase();

    
    // Populate modal with event data
    document.getElementById('modalEventTitle').textContent = event.title;
    document.getElementById('modalEventDateTime').textContent = 
        `${formattedDate} at ${formattedTime}`;
    document.getElementById('modalEventDescription').textContent = event.description;
    document.getElementById('modalEventLocation').textContent = event.location;
    document.getElementById('modalEventPrize').textContent = event.prize;
    document.getElementById('modalEventCreator').textContent = event.createdBy;
    
    // Store event ID for booking
    modal.dataset.eventId = event.id;
    
    // Show modal
    modal.classList.add('active');
    } catch(error){
        console.error("Error opening modal:", error);
         console.log('Event element:', eventElement);
        console.log('Data attribute:', eventElement.getAttribute('data-event'));
    }
}

// Function to close modal
function closeModal() {
    const modal = document.getElementById('eventModal');
    modal.classList.remove('active');
}

// Function to book event
function bookEvent() {
    const modal = document.getElementById('eventModal');
    const eventId = modal.dataset.eventId;
    
    // Add your booking logic here
    // For example, redirect to booking page or make API call
    window.location.href = `/book-event/${eventId}`;
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modal = document.getElementById('eventModal');
    if (event.target === modal) {
        closeModal();
    }
}

// Close modal on Escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeModal();
    }
}); 

// Example: Add click listeners to event cards
document.addEventListener('DOMContentLoaded', function() {
    const eventCards = document.querySelectorAll('.event-card');
    
    eventCards.forEach(card => {
        card.addEventListener('click', function() {
            // Get event data from card or data attributes
            const eventData = {
                id: this.dataset.eventId,
                title: this.querySelector('.event-title').textContent,
                date: this.dataset.eventDate,
                time: this.dataset.eventTime,
                description: this.querySelector('.event-description').textContent,
                location: this.dataset.eventLocation,
                prize: this.dataset.eventPrize,
                createdBy: this.dataset.eventCreator
            };
            
            openEventModal(eventData);
        });
    });
});
</script>